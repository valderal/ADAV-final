"0","# MSE function from lab 3"
"0","mse <- function(y_true, y_pred) {"
"0","  mean((y_true - y_pred)^2)"
"0","}"
"0",""
"0","# MSE on a validation dataset for predictions from a linear model function from"
"0","# lab 4"
"0","lm_mse <- function(formula, train_data, valid_data) {"
"0","  y_name <- as.character(formula)[2]"
"0","  y_true <- valid_data[[y_name]]"
"0","  "
"0","  lm_fit <- lm(formula, train_data)"
"0","  y_pred <- predict(lm_fit, newdata = valid_data)"
"0","  "
"0","  mean((y_true - y_pred)^2)"
"0","}"
"0",""
"0","# sourcing the generate formulas function from lab 4"
"0","source(""generate_formulas.R"")"
"0",""
"0","# object with all potential predictor variables"
"0","x_vars <- colnames(select(df, -base_total))"
"0",""
"0","# function to find the best model for x amount of predictors, using code from"
"0","# lab 4"
"0","best_n_preds <- function(n) {"
"0","  formulas <- generate_formulas(p = n, x_vars = x_vars, y_var = ""base_total"")"
"0","  amount <- length(formulas)"
"0","  mses <- rep(0, amount)"
"0","  for (i in 1:amount) {"
"0","    mses[i] <- lm_mse(as.formula(formulas[i]), pokemon_train, pokemon_valid)"
"0","  }"
"0","  best_preds <- formulas[which.min(mses)]"
"0","  min_mse <- lm_mse(as.formula(best_preds), pokemon_train, pokemon_valid)"
"0","  cat(best_preds, ""| MSE"", min_mse)"
"0","}"
"0",""
"0","# find the best models for 1 to 5 predictors"
"0","# time to compute on high-end pc: ~3 minutes (as point of reference for how long "
"0","# this will take, especially with laptops this can and will take longer)"
"0","for (bip in 1:5) {"
"0","  cat(bip, ""predictor(s):\n"")"
"0","  best_n_preds(bip)"
"0","  cat(""\n"")"
"0","}"
"1","1"
"1"," "
"1","predictor(s):
"
"1","base_total ~ capture_rate"
"1"," "
"1","| MSE"
"1"," "
"1","6414.483"
"1","
"
"1","2"
"1"," "
"1","predictor(s):
"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"1","base_total ~ is_legendary + capture_rate"
"1"," "
"1","| MSE"
"1"," "
"1","5664.163"
"1","
"
"1","3"
"1"," "
"1","predictor(s):
"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"1","base_total ~ is_legendary + height_m + capture_rate"
"1"," "
"1","| MSE"
"1"," "
"1","5306.173"
"1","
"
"1","4"
"1"," "
"1","predictor(s):
"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"1","base_total ~ generation + is_legendary + height_m + capture_rate"
"1"," "
"1","| MSE"
"1"," "
"1","5260.425"
"1","
"
"1","5"
"1"," "
"1","predictor(s):
"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"2","Warning: prediction from rank-deficient fit; attr(*, ""non-estim"") has doubtful cases"
"1","base_total ~ generation + is_legendary + height_m + capture_rate + single_type"
"1"," "
"1","| MSE"
"1"," "
"1","5224.959"
"1","
"
"0","# trying 5 predictor model"
"0","mse_5_pred <-lm_mse(base_total ~ generation + is_legendary + height_m + "
"0","                      capture_rate + single_type, pokemon_train, pokemon_valid)"
"0","summary(lm(as.formula(base_total ~ generation + is_legendary + height_m + "
"0","                      capture_rate + single_type), data = pokemon_train))"
"1","
Call:
"
"1",""
"1","lm(formula = as.formula(base_total ~ generation + is_legendary + 
    height_m + capture_rate + single_type), data = pokemon_train)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-310.078 "
"1"," -37.858 "
"1","   2.378 "
"1","  38.316 "
"1"," 204.438 "
"1","
"
"1","
Coefficients:
"
"1","            "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept) "
"1"," 453.39351"
"1","   11.93638"
"1","  37.984"
"1","  < 2e-16"
"1"," ***"
"1","
generation  "
"1","   2.21123"
"1","    1.82485"
"1","   1.212"
"1","    0.226"
"1","    "
"1","
is_legendary"
"1","  75.28996"
"1","   14.00693"
"1","   5.375"
"1"," 1.31e-07"
"1"," ***"
"1","
height_m    "
"1","  37.38724"
"1","    4.04176"
"1","   9.250"
"1","  < 2e-16"
"1"," ***"
"1","
capture_rate"
"1","  -0.82284"
"1","    0.05281"
"1"," -15.580"
"1","  < 2e-16"
"1"," ***"
"1","
single_type "
"1","  -4.53313"
"1","    7.10237"
"1","  -0.638"
"1","    0.524"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","70.49"
"1"," "
"1","on"
"1"," "
"1","396"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.6613"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.657"
"1"," "
"1","
F-statistic:"
"1"," "
"1","154.6"
"1"," "
"1","on"
"1"," "
"1","5"
"1"," "
"1","and"
"1"," "
"1","396"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# trying 3 predictor model"
"0","summary(lm(base_total ~ is_legendary + height_m + capture_rate, "
"0","           data = pokemon_train))"
"1","
Call:
"
"1",""
"1","lm(formula = base_total ~ is_legendary + height_m + capture_rate, 
    data = pokemon_train)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-307.111 "
"1"," -36.327 "
"1","   2.738 "
"1","  37.273 "
"1"," 206.627 "
"1","
"
"1","
Coefficients:
"
"1","            "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept) "
"1"," 459.48253"
"1","    8.76089"
"1","  52.447"
"1","  < 2e-16"
"1"," ***"
"1","
is_legendary"
"1","  77.34689"
"1","   13.88413"
"1","   5.571"
"1"," 4.68e-08"
"1"," ***"
"1","
height_m    "
"1","  37.41673"
"1","    4.00972"
"1","   9.332"
"1","  < 2e-16"
"1"," ***"
"1","
capture_rate"
"1","  -0.82670"
"1","    0.05273"
"1"," -15.677"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","70.48"
"1"," "
"1","on"
"1"," "
"1","398"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.6596"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.6571"
"1"," "
"1","
F-statistic:"
"1"," "
"1","257.1"
"1"," "
"1","on"
"1"," "
"1","3"
"1"," "
"1","and"
"1"," "
"1","398"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# saving values of final 3 predictor model"
"0","formula_3_pred <- base_total ~ is_legendary + height_m + capture_rate"
"0","mse_3_pred <- lm_mse(as.formula(formula_3_pred), pokemon_train, pokemon_valid)"
